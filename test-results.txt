Loaded suite ./test/collection_test
Started
..........E....F...E....EEEEEFE.FE.EEEEEE.EFEEE..FEEEEEEFF.F..EEFEFFEFFFF......
Finished in 5.121000 seconds.

  1) Error:
test: Creating indexes should create index using symbols. (TestCollection):
NativeException: com.mongodb.CommandResult$CommandFailure: command failed [command failed [deleteIndexes] { "errmsg" : "index not found" , "ok" : 0.0}
    com/mongodb/CommandResult.java:70:in `getException'
    com/mongodb/CommandResult.java:116:in `throwOnError'
    com/mongodb/DBCollection.java:672:in `dropIndexes'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:83:in `_drop_index'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:326:in `drop_index'
    ./test/collection_test.rb:856:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:13:in `test: Creating indexes should create index using symbols. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  2) Failure:
test: Creating indexes should generate indexes in the proper order. (TestCollection) [./test/collection_test.rb:933]:
not all expectations were satisfied
unsatisfied expectations:
- expected exactly once, not yet invoked: #<Mongo::Collection:0x2024>.insert_documents(any_parameters)


  3) Error:
test: Drop index should drop an index which was given a specific name. (TestCollection):
NativeException: com.mongodb.CommandResult$CommandFailure: command failed [command failed [deleteIndexes] { "errmsg" : "index not found" , "ok" : 0.0}
    com/mongodb/CommandResult.java:70:in `getException'
    com/mongodb/CommandResult.java:116:in `throwOnError'
    com/mongodb/DBCollection.java:672:in `dropIndexes'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:83:in `_drop_index'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:326:in `drop_index'
    ./test/collection_test.rb:825:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:13:in `test: Drop index should drop an index which was given a specific name. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  4) Error:
test: Grouping should finalize grouped results. (TestCollection):
Mongo::OperationFailure: Database command 'group' failed: (errmsg: 'exception: reduce setup exec failed: JS Error: SyntaxError: syntax error reduce setup:1'; code: '10228'; ok: '0.0').
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:179:in `command'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:508:in `__group'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:425:in `group'
    ./test/collection_test.rb:734:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:382:in `test: Grouping should finalize grouped results. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  5) Error:
test: Grouping should group results using eval form. (TestCollection):
Mongo::OperationFailure: Database command 'group' failed: (errmsg: 'exception: reduce setup exec failed: JS Error: SyntaxError: syntax error reduce setup:1'; code: '10228'; ok: '0.0').
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:179:in `command'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:508:in `__group'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:425:in `group'
    ./test/collection_test.rb:727:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:382:in `test: Grouping should group results using eval form. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  6) Error:
test: Grouping with a key function should group filtered results. (TestCollection):
Mongo::OperationFailure: Database command 'group' failed: (errmsg: 'exception: reduce setup exec failed: JS Error: SyntaxError: syntax error reduce setup:1'; code: '10228'; ok: '0.0').
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:179:in `command'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:508:in `__group'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:425:in `group'
    ./test/collection_test.rb:775:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:382:in `test: Grouping with a key function should group filtered results. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  7) Error:
test: Grouping with a key function should group results. (TestCollection):
Mongo::OperationFailure: Database command 'group' failed: (errmsg: 'exception: reduce setup exec failed: JS Error: SyntaxError: syntax error reduce setup:1'; code: '10228'; ok: '0.0').
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:179:in `command'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:508:in `__group'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:425:in `group'
    ./test/collection_test.rb:769:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:382:in `test: Grouping with a key function should group results. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  8) Error:
test: Grouping with key should group. (TestCollection):
Mongo::OperationFailure: Database command 'group' failed: (errmsg: 'exception: reduce setup exec failed: JS Error: SyntaxError: syntax error reduce setup:1'; code: '10228'; ok: '0.0').
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:179:in `command'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:508:in `__group'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:425:in `group'
    ./test/collection_test.rb:750:in `TestCollection'
    org/jruby/RubyMethod.java:117:in `call'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/shoulda-2.11.3/lib/shoulda/context.rb:382:in `test: Grouping with key should group. '
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

  9) Failure:
test_bulk_insert_with_continue_on_error(TestCollection) [./test/collection_test.rb:162]:
[Mongo::OperationFailure] exception expected, not
Class: <NativeException>
Message: <"com.mongodb.MongoException$DuplicateKey: E11000 duplicate key error index: ruby-test-db.test.$foo_1  dup key: { : 1 }">
---Backtrace---
com/mongodb/CommandResult.java:80:in `getException'
com/mongodb/CommandResult.java:116:in `throwOnError'
com/mongodb/DBTCPConnector.java:126:in `_checkWriteError'
com/mongodb/DBTCPConnector.java:148:in `say'
com/mongodb/DBTCPConnector.java:132:in `say'
com/mongodb/DBApiLayer.java:262:in `insert'
com/mongodb/DBApiLayer.java:217:in `insert'
com/mongodb/DBCollection.java:118:in `insert'
/home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:145:in `insert_documents'
/home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:215:in `insert'
./test/collection_test.rb:163:in `test_bulk_insert_with_continue_on_error'
---------------

 10) Error:
test_capped_method(TestCollection):
Mongo::MongoDBError: Collection normal already exists. Currently in strict mode.
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:82:in `create_collection'
    ./test/collection_test.rb:14:in `test_capped_method'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 11) Failure:
test_collection(TestCollection) [./test/collection_test.rb:71]:
Expected nil to be a kind of Mongo::Collection, not NilClass.

 12) Error:
test_count(TestCollection):
ArgumentError: wrong number of arguments (1 for 0)
    ./test/collection_test.rb:321:in `test_count'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 13) Error:
test_distinct_queries(TestCollection):
NameError: no method 'distinct' for arguments (org.jruby.RubySymbol) on #<Class:0x120b301ff>
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:544:in `distinct'
    ./test/collection_test.rb:125:in `test_distinct_queries'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 14) Error:
test_ensure_index(TestCollection):
NativeException: com.mongodb.CommandResult$CommandFailure: command failed [command failed [deleteIndexes] { "errmsg" : "index not found" , "ok" : 0.0}
    com/mongodb/CommandResult.java:70:in `getException'
    com/mongodb/CommandResult.java:116:in `throwOnError'
    com/mongodb/DBCollection.java:672:in `dropIndexes'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:83:in `_drop_index'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:326:in `drop_index'
    ./test/collection_test.rb:671:in `test_ensure_index'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:13:in `run'

 15) Error:
test_ensure_index_timeout(TestCollection):
NoMethodError: undefined method `cache_time=' for #<Mongo::DB:0x2e7a656f>
    ./test/collection_test.rb:691:in `test_ensure_index_timeout'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 16) Error:
test_fields_as_hash(TestCollection):
NativeException: com.mongodb.MongoException: Unsupported projection option: b
    com/mongodb/MongoException.java:82:in `parse'
    com/mongodb/DBApiLayer.java:310:in `__find'
    com/mongodb/DBCollection.java:565:in `findOne'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:154:in `find_one_document'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:176:in `find_one'
    ./test/collection_test.rb:363:in `test_fields_as_hash'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 17) Error:
test_fields_with_slice(TestCollection):
NativeException: com.mongodb.MongoException: Unsupported projection option: foo
    com/mongodb/MongoException.java:82:in `parse'
    com/mongodb/DBApiLayer.java:310:in `__find'
    com/mongodb/DBCollection.java:565:in `findOne'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:154:in `find_one_document'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:176:in `find_one'
    ./test/collection_test.rb:383:in `test_fields_with_slice'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 18) Error:
test_filter_collection_with_query(TestCollection):
Java::JavaLang::NullPointerException: 
    org.jruby.util.CodegenUtils.human(CodegenUtils.java:98)
    org.jruby.util.CodegenUtils.prettyParams(CodegenUtils.java:152)
    org.jruby.java.dispatch.CallableSelector.argumentError(CallableSelector.java:462)
    org.jruby.java.dispatch.CallableSelector.argTypesDoNotMatch(CallableSelector.java:436)
    org.jruby.java.invokers.RubyToJavaInvoker.findCallableArityTwo(RubyToJavaInvoker.java:248)
    org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:66)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:332)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:203)
    org.jruby.ast.CallTwoArgNode.interpret(CallTwoArgNode.java:59)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.IfNode.interpret(IfNode.java:117)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:233)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:195)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:332)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:203)
    $_dot_.test.collection_test.method__13$RUBY$test_filter_collection_with_query(./test/collection_test.rb:132)
    $_dot_$test$collection_test$method__13$RUBY$test_filter_collection_with_query.call($_dot_$test$collection_test$method__13$RUBY$test_filter_collection_with_query:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.ast.EnsureNode.interpret(EnsureNode.java:96)
    org.jruby.ast.BeginNode.interpret(BeginNode.java:83)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.EnsureNode.interpret(EnsureNode.java:96)
    org.jruby.ast.BeginNode.interpret(BeginNode.java:83)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 19) Error:
test_find_and_modify(TestCollection):
Java::JavaLang::NullPointerException: 
    org.jruby.util.CodegenUtils.human(CodegenUtils.java:98)
    org.jruby.util.CodegenUtils.prettyParams(CodegenUtils.java:152)
    org.jruby.java.dispatch.CallableSelector.argumentError(CallableSelector.java:462)
    org.jruby.java.dispatch.CallableSelector.argTypesDoNotMatch(CallableSelector.java:436)
    org.jruby.java.invokers.RubyToJavaInvoker.findCallable(RubyToJavaInvoker.java:191)
    org.jruby.java.invokers.InstanceMethodInvoker.call(InstanceMethodInvoker.java:28)
    org.jruby.internal.runtime.methods.AliasMethod.call(AliasMethod.java:76)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:282)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:71)
    org.jruby.ast.CallManyArgsNode.interpret(CallManyArgsNode.java:59)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:120)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:134)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:154)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:282)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:71)
    org.jruby.ast.FCallManyArgsNode.interpret(FCallManyArgsNode.java:60)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    $_dot_.test.collection_test.method__44$RUBY$test_find_and_modify(./test/collection_test.rb:549)
    $_dot_$test$collection_test$method__44$RUBY$test_find_and_modify.call($_dot_$test$collection_test$method__44$RUBY$test_find_and_modify:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.ast.EnsureNode.interpret(EnsureNode.java:96)
    org.jruby.ast.BeginNode.interpret(BeginNode.java:83)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.EnsureNode.interpret(EnsureNode.java:96)
    org.jruby.ast.BeginNode.interpret(BeginNode.java:83)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 20) Failure:
test_find_and_modify_with_invalid_options(TestCollection) [./test/collection_test.rb:559]:
[Mongo::OperationFailure] exception expected, not
Class: <NativeException>
Message: <"com.mongodb.CommandResult$CommandFailure: command failed [command failed [findandmodify] { \"errmsg\" : \"exception: must specify remove or update\" , \"code\" : 12516 , \"ok\" : 0.0}">
---Backtrace---
com/mongodb/CommandResult.java:70:in `getException'
com/mongodb/CommandResult.java:116:in `throwOnError'
com/mongodb/DBCollection.java:319:in `findAndModify'
/home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:150:in `find_and_modify_document'
/home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:365:in `find_and_modify'
./test/collection_test.rb:560:in `test_find_and_modify_with_invalid_options'
---------------

 21) Error:
test_find_one(TestCollection):
TypeError: can't convert String into Integer
    org/jruby/java/proxies/JavaProxy.java:136:in `[]'
    ./test/collection_test.rb:397:in `test_find_one'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 22) Error:
test_find_one_with_transformer(TestCollection):
NativeException: java.lang.IllegalArgumentException: can't serialize class org.jruby.RubyProc
    org/bson/BSONEncoder.java:234:in `_putObjectField'
    org/bson/BSONEncoder.java:140:in `putObject'
    org/bson/BSONEncoder.java:86:in `putObject'
    com/mongodb/OutMessage.java:190:in `putObject'
    com/mongodb/OutMessage.java:65:in `_appendQuery'
    com/mongodb/OutMessage.java:40:in `query'
    com/mongodb/DBApiLayer.java:301:in `__find'
    com/mongodb/DBCollection.java:565:in `findOne'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:154:in `find_one_document'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:176:in `find_one'
    ./test/collection_test.rb:652:in `test_find_one_with_transformer'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 23) Error:
test_find_with_transformer(TestCollection):
RuntimeError: Unknown options [{:transformer=>#<Proc:0x7e9c91b0@./test/collection_test.rb:643>}]
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:137:in `find'
    ./test/collection_test.rb:644:in `test_find_with_transformer'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'

 24) Failure:
test_limit_and_skip(TestCollection) [./test/collection_test.rb:600]:
<nil> expected but was
<{}>.

 25) Error:
test_map_reduce(TestCollection):
Java::JavaLang::ClassCastException: org.jruby.RubySymbol cannot be cast to java.lang.String
    org.bson.BasicBSONObject.put(BasicBSONObject.java:32)
    org.jruby.java.proxies.MapJavaProxy$RubyHashMap.internalPut(MapJavaProxy.java:120)
    org.jruby.RubyHash.internalPut(RubyHash.java:474)
    org.jruby.RubyHash.fastASetCheckString(RubyHash.java:864)
    org.jruby.RubyHash.op_aset(RubyHash.java:888)
    org.jruby.RubyHash$25.visit(RubyHash.java:1586)
    org.jruby.RubyHash.visitAll(RubyHash.java:594)
    org.jruby.RubyHash.merge_bang19(RubyHash.java:1578)
    org.jruby.java.proxies.MapJavaProxy.merge_bang19(MapJavaProxy.java:622)
    org.jruby.java.proxies.MapJavaProxy$i$1$0$merge_bang19.call(MapJavaProxy$i$1$0$merge_bang19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:319)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:276)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:211)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:352)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:237)
    $_dot_.test.collection_test.method__38$RUBY$test_map_reduce(./test/collection_test.rb:463)
    $_dot_$test$collection_test$method__38$RUBY$test_map_reduce.call($_dot_$test$collection_test$method__38$RUBY$test_map_reduce:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_2_rescue_1$RUBY$SYNTHETIC__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_1_ensure_2$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_0_ensure_1$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    org.jruby.internal.runtime.methods.JittedMethod.call(JittedMethod.java:167)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 26) Error:
test_map_reduce_with_code_objects(TestCollection):
Java::JavaLang::ClassCastException: org.jruby.RubySymbol cannot be cast to java.lang.String
    org.bson.BasicBSONObject.put(BasicBSONObject.java:32)
    org.jruby.java.proxies.MapJavaProxy$RubyHashMap.internalPut(MapJavaProxy.java:120)
    org.jruby.RubyHash.internalPut(RubyHash.java:474)
    org.jruby.RubyHash.fastASetCheckString(RubyHash.java:864)
    org.jruby.RubyHash.op_aset(RubyHash.java:888)
    org.jruby.RubyHash$25.visit(RubyHash.java:1586)
    org.jruby.RubyHash.visitAll(RubyHash.java:594)
    org.jruby.RubyHash.merge_bang19(RubyHash.java:1578)
    org.jruby.java.proxies.MapJavaProxy.merge_bang19(MapJavaProxy.java:622)
    org.jruby.java.proxies.MapJavaProxy$i$1$0$merge_bang19.call(MapJavaProxy$i$1$0$merge_bang19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:319)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:276)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:211)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:352)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:237)
    $_dot_.test.collection_test.method__39$RUBY$test_map_reduce_with_code_objects(./test/collection_test.rb:474)
    $_dot_$test$collection_test$method__39$RUBY$test_map_reduce_with_code_objects.call($_dot_$test$collection_test$method__39$RUBY$test_map_reduce_with_code_objects:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_2_rescue_1$RUBY$SYNTHETIC__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_1_ensure_2$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_0_ensure_1$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    org.jruby.internal.runtime.methods.JittedMethod.call(JittedMethod.java:167)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 27) Error:
test_map_reduce_with_collection_merge(TestCollection):
Java::JavaLang::ClassCastException: org.jruby.RubySymbol cannot be cast to java.lang.String
    org.bson.BasicBSONObject.put(BasicBSONObject.java:32)
    org.jruby.java.proxies.MapJavaProxy$RubyHashMap.internalPut(MapJavaProxy.java:120)
    org.jruby.RubyHash.internalPut(RubyHash.java:474)
    org.jruby.RubyHash.fastASetCheckString(RubyHash.java:864)
    org.jruby.RubyHash.op_aset(RubyHash.java:888)
    org.jruby.RubyHash$25.visit(RubyHash.java:1586)
    org.jruby.RubyHash.visitAll(RubyHash.java:594)
    org.jruby.RubyHash.merge_bang19(RubyHash.java:1578)
    org.jruby.java.proxies.MapJavaProxy.merge_bang19(MapJavaProxy.java:622)
    org.jruby.java.proxies.MapJavaProxy$i$1$0$merge_bang19.call(MapJavaProxy$i$1$0$merge_bang19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:319)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:276)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:211)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:352)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:237)
    $_dot_.test.collection_test.method__43$RUBY$test_map_reduce_with_collection_merge(./test/collection_test.rb:521)
    $_dot_$test$collection_test$method__43$RUBY$test_map_reduce_with_collection_merge.call($_dot_$test$collection_test$method__43$RUBY$test_map_reduce_with_collection_merge:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_2_rescue_1$RUBY$SYNTHETIC__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_1_ensure_2$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_0_ensure_1$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    org.jruby.internal.runtime.methods.JittedMethod.call(JittedMethod.java:167)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 28) Error:
test_map_reduce_with_options(TestCollection):
Java::JavaLang::ClassCastException: org.jruby.RubySymbol cannot be cast to java.lang.String
    org.bson.BasicBSONObject.put(BasicBSONObject.java:32)
    org.jruby.java.proxies.MapJavaProxy$RubyHashMap.internalPut(MapJavaProxy.java:120)
    org.jruby.RubyHash.internalPut(RubyHash.java:474)
    org.jruby.RubyHash.fastASetCheckString(RubyHash.java:864)
    org.jruby.RubyHash.op_aset(RubyHash.java:888)
    org.jruby.RubyHash$25.visit(RubyHash.java:1586)
    org.jruby.RubyHash.visitAll(RubyHash.java:594)
    org.jruby.RubyHash.merge_bang19(RubyHash.java:1578)
    org.jruby.java.proxies.MapJavaProxy.merge_bang19(MapJavaProxy.java:622)
    org.jruby.java.proxies.MapJavaProxy$i$1$0$merge_bang19.call(MapJavaProxy$i$1$0$merge_bang19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:319)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:276)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:211)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:352)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:237)
    $_dot_.test.collection_test.method__40$RUBY$test_map_reduce_with_options(./test/collection_test.rb:487)
    $_dot_$test$collection_test$method__40$RUBY$test_map_reduce_with_options.call($_dot_$test$collection_test$method__40$RUBY$test_map_reduce_with_options:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_2_rescue_1$RUBY$SYNTHETIC__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_1_ensure_2$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_0_ensure_1$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    org.jruby.internal.runtime.methods.JittedMethod.call(JittedMethod.java:167)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 29) Error:
test_map_reduce_with_output_collection(TestCollection):
Java::JavaLang::ClassCastException: org.jruby.RubySymbol cannot be cast to java.lang.String
    org.bson.BasicBSONObject.put(BasicBSONObject.java:32)
    org.jruby.java.proxies.MapJavaProxy$RubyHashMap.internalPut(MapJavaProxy.java:120)
    org.jruby.RubyHash.internalPut(RubyHash.java:474)
    org.jruby.RubyHash.fastASetCheckString(RubyHash.java:864)
    org.jruby.RubyHash.op_aset(RubyHash.java:888)
    org.jruby.RubyHash$25.visit(RubyHash.java:1586)
    org.jruby.RubyHash.visitAll(RubyHash.java:594)
    org.jruby.RubyHash.merge_bang19(RubyHash.java:1578)
    org.jruby.java.proxies.MapJavaProxy.merge_bang19(MapJavaProxy.java:622)
    org.jruby.java.proxies.MapJavaProxy$i$1$0$merge_bang19.call(MapJavaProxy$i$1$0$merge_bang19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:319)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:276)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:211)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:352)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:237)
    $_dot_.test.collection_test.method__42$RUBY$test_map_reduce_with_output_collection(./test/collection_test.rb:506)
    $_dot_$test$collection_test$method__42$RUBY$test_map_reduce_with_output_collection.call($_dot_$test$collection_test$method__42$RUBY$test_map_reduce_with_output_collection:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_2_rescue_1$RUBY$SYNTHETIC__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_1_ensure_2$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_0_ensure_1$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    org.jruby.internal.runtime.methods.JittedMethod.call(JittedMethod.java:167)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 30) Error:
test_map_reduce_with_raw_response(TestCollection):
Java::JavaLang::ClassCastException: org.jruby.RubySymbol cannot be cast to java.lang.String
    org.bson.BasicBSONObject.put(BasicBSONObject.java:32)
    org.jruby.java.proxies.MapJavaProxy$RubyHashMap.internalPut(MapJavaProxy.java:120)
    org.jruby.RubyHash.internalPut(RubyHash.java:474)
    org.jruby.RubyHash.fastASetCheckString(RubyHash.java:864)
    org.jruby.RubyHash.op_aset(RubyHash.java:888)
    org.jruby.RubyHash$25.visit(RubyHash.java:1586)
    org.jruby.RubyHash.visitAll(RubyHash.java:594)
    org.jruby.RubyHash.merge_bang19(RubyHash.java:1578)
    org.jruby.java.proxies.MapJavaProxy.merge_bang19(MapJavaProxy.java:622)
    org.jruby.java.proxies.MapJavaProxy$i$1$0$merge_bang19.call(MapJavaProxy$i$1$0$merge_bang19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodOneOrNBlock.call(JavaMethod.java:319)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:276)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:211)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:352)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:237)
    $_dot_.test.collection_test.method__41$RUBY$test_map_reduce_with_raw_response(./test/collection_test.rb:496)
    $_dot_$test$collection_test$method__41$RUBY$test_map_reduce_with_raw_response.call($_dot_$test$collection_test$method__41$RUBY$test_map_reduce_with_raw_response:65535)
    org.jruby.RubyClass.finvoke(RubyClass.java:523)
    org.jruby.RubyBasicObject.send19(RubyBasicObject.java:1685)
    org.jruby.RubyBasicObject$i$send19.call(RubyBasicObject$i$send19.gen:65535)
    org.jruby.internal.runtime.methods.JavaMethod$JavaMethodZeroOrOneOrNBlock.call(JavaMethod.java:266)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_2_rescue_1$RUBY$SYNTHETIC__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_1_ensure_2$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.chained_0_ensure_1$RUBY$__ensure__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23)
    rubyjit.run_9A42DB410F342DD31E49D3F9C7D7FABDDED345C8.__file__(/home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb)
    org.jruby.internal.runtime.methods.JittedMethod.call(JittedMethod.java:167)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:167)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:142)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:154)
    org.jruby.runtime.Block.yield(Block.java:130)
    org.jruby.RubyArray.eachCommon(RubyArray.java:1596)
    org.jruby.RubyArray.each(RubyArray.java:1603)
    org.jruby.RubyArray$i$0$0$each.call(RubyArray$i$0$0$each.gen:65535)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:302)
    org.jruby.runtime.callsite.CachingCallSite.callBlock(CachingCallSite.java:144)
    org.jruby.runtime.callsite.CachingCallSite.callIter(CachingCallSite.java:153)
    org.jruby.ast.CallNoArgBlockNode.interpret(CallNoArgBlockNode.java:64)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.FCallOneArgNode.interpret(FCallOneArgNode.java:36)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.ast.RescueNode.executeBody(RescueNode.java:216)
    org.jruby.ast.RescueNode.interpretWithJavaExceptions(RescueNode.java:120)
    org.jruby.ast.RescueNode.interpret(RescueNode.java:110)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_METHOD(ASTInterpreter.java:75)
    org.jruby.internal.runtime.methods.InterpretedMethod.call(InterpretedMethod.java:190)
    org.jruby.internal.runtime.methods.DefaultMethod.call(DefaultMethod.java:179)
    org.jruby.runtime.callsite.CachingCallSite.cacheAndCall(CachingCallSite.java:312)
    org.jruby.runtime.callsite.CachingCallSite.call(CachingCallSite.java:169)
    org.jruby.ast.CallOneArgNode.interpret(CallOneArgNode.java:57)
    org.jruby.ast.DAsgnNode.interpret(DAsgnNode.java:110)
    org.jruby.ast.NewlineNode.interpret(NewlineNode.java:104)
    org.jruby.ast.BlockNode.interpret(BlockNode.java:71)
    org.jruby.evaluator.ASTInterpreter.INTERPRET_BLOCK(ASTInterpreter.java:112)
    org.jruby.runtime.Interpreted19Block.evalBlockBody(Interpreted19Block.java:203)
    org.jruby.runtime.Interpreted19Block.yield(Interpreted19Block.java:191)
    org.jruby.runtime.Interpreted19Block.call(Interpreted19Block.java:122)
    org.jruby.runtime.Block.call(Block.java:89)
    org.jruby.RubyProc.call(RubyProc.java:274)
    org.jruby.RubyProc.call(RubyProc.java:233)
    org.jruby.Ruby.tearDown(Ruby.java:2739)
    org.jruby.Ruby.tearDown(Ruby.java:2726)
    org.jruby.Main.internalRun(Main.java:201)
    org.jruby.Main.run(Main.java:164)
    org.jruby.Main.run(Main.java:148)
    org.jruby.util.ShellLauncher$ScriptThreadProcess.run(ShellLauncher.java:140)
    java.lang.Thread.run(Thread.java:722)

 31) Failure:
test_maximum_insert_size(TestCollection) [./test/collection_test.rb:189]:
Mongo::InvalidOperation expected but nothing was raised.

 32) Failure:
test_mocked_safe_remove(TestCollection) [./test/collection_test.rb:294]:
Mongo::OperationFailure expected but nothing was raised.

 33) Failure:
test_nil_id(TestCollection) [./test/collection_test.rb:96]:
[Mongo::OperationFailure] exception expected, not
Class: <NativeException>
Message: <"com.mongodb.MongoException$DuplicateKey: E11000 duplicate key error index: ruby-test-db.test.$_id_  dup key: { : 5 }">
---Backtrace---
com/mongodb/CommandResult.java:80:in `getException'
com/mongodb/CommandResult.java:116:in `throwOnError'
com/mongodb/DBTCPConnector.java:126:in `_checkWriteError'
com/mongodb/DBTCPConnector.java:148:in `say'
com/mongodb/DBTCPConnector.java:132:in `say'
com/mongodb/DBApiLayer.java:262:in `insert'
com/mongodb/DBApiLayer.java:217:in `insert'
com/mongodb/DBCollection.java:118:in `insert'
/home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:145:in `insert_documents'
/home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:215:in `insert'
./test/collection_test.rb:97:in `test_nil_id'
---------------

 34) Error:
test_optional_pk_factory(TestCollection):
Mongo::MongoDBError: Collection more-stuff already exists. Currently in strict mode.
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:82:in `create_collection'
    ./test/collection_test.rb:26:in `test_optional_pk_factory'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23:in `run'

 35) Error:
test_pk_factory_on_collection(TestCollection):
NoMethodError: undefined method `j_db' for "foo":String
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:41:in `initialize'
    ./test/collection_test.rb:45:in `test_pk_factory_on_collection'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23:in `run'

 36) Failure:
test_remove_return_value(TestCollection) [./test/collection_test.rb:310]:
<true> expected but was
<false>.

 37) Error:
test_rename_collection(TestCollection):
Mongo::MongoArgumentError: command must be given a selector
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:164:in `command'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/db.rb:134:in `rename_collection'
    /home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:559:in `rename'
    ./test/collection_test.rb:87:in `test_rename_collection'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23:in `run'

 38) Failure:
test_safe_insert(TestCollection) [./test/collection_test.rb:149]:
[Mongo::OperationFailure] exception expected, not
Class: <NativeException>
Message: <"com.mongodb.MongoException$DuplicateKey: E11000 duplicate key error index: ruby-test-db.test.$_id_  dup key: { : ObjectId('4e7ae72ae4b0aff7d7b8fdff') }">
---Backtrace---
com/mongodb/CommandResult.java:80:in `getException'
com/mongodb/CommandResult.java:116:in `throwOnError'
com/mongodb/DBTCPConnector.java:126:in `_checkWriteError'
com/mongodb/DBTCPConnector.java:148:in `say'
com/mongodb/DBTCPConnector.java:132:in `say'
com/mongodb/DBApiLayer.java:262:in `insert'
com/mongodb/DBApiLayer.java:217:in `insert'
com/mongodb/DBCollection.java:118:in `insert'
/home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:145:in `insert_documents'
/home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:215:in `insert'
./test/collection_test.rb:150:in `test_safe_insert'
---------------

 39) Failure:
test_safe_mode_with_advanced_safe_with_invalid_options(TestCollection) [./test/collection_test.rb:196]:
<ArgumentError> expected but was
<NativeException>.

 40) Error:
test_safe_remove(TestCollection):
NoMethodError: undefined method `[]' for true:TrueClass
    ./test/collection_test.rb:305:in `test_safe_remove'
    org/jruby/RubyBasicObject.java:1685:in `__send__'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:27:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:24:in `run'
    /home/gb/.rvm/gems/jruby-1.6.4/gems/mocha-0.10.0/lib/mocha/integration/mini_test/version_142_to_172.rb:23:in `run'

 41) Failure:
test_safe_save(TestCollection) [./test/collection_test.rb:281]:
[Mongo::OperationFailure] exception expected, not
Class: <NativeException>
Message: <"com.mongodb.MongoException$DuplicateKey: E11000 duplicate key error index: ruby-test-db.test.$hello  dup key: { : \"world\" }">
---Backtrace---
com/mongodb/CommandResult.java:80:in `getException'
com/mongodb/CommandResult.java:116:in `throwOnError'
com/mongodb/DBTCPConnector.java:126:in `_checkWriteError'
com/mongodb/DBTCPConnector.java:148:in `say'
com/mongodb/DBTCPConnector.java:132:in `say'
com/mongodb/DBApiLayer.java:262:in `insert'
com/mongodb/DBApiLayer.java:217:in `insert'
com/mongodb/DBCollection.java:71:in `insert'
com/mongodb/DBCollection.java:633:in `save'
/home/gb/dev/music-glue/jmongo/lib/jmongo/ajrb.rb:165:in `save_document'
/home/gb/dev/music-glue/jmongo/lib/jmongo/collection.rb:193:in `save'
./test/collection_test.rb:282:in `test_safe_save'
---------------

 42) Failure:
test_safe_update(TestCollection) [./test/collection_test.rb:268]:
Mongo::OperationFailure expected but nothing was raised.

 43) Failure:
test_save_adds_id(TestCollection) [./test/collection_test.rb:427]:
Failed assertion, no message given.

 44) Failure:
test_save_symbol_find_string(TestCollection) [./test/collection_test.rb:586]:
<:mike> expected but was
<"mike">.

79 tests, 105 assertions, 15 failures, 29 errors, 0 skips

Test run options: --seed 54673
